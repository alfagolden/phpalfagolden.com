<?php
/**
 * صفحة تسجيل الخروج
 *
 * هذا الملف مسؤول عن إنهاء جلسة المستخدم بشكل آمن وإعادة توجيهه
 * إلى صفحة تسجيل الدخول.
 */

// الخطوة 1: بدء الجلسة أو استئنافها
// هذا الإجراء ضروري للوصول إلى بيانات الجلسة الحالية وتدميرها.
// يجب أن يكون هذا السطر هو الأول دائماً قبل أي تعامل مع الجلسات.
session_start();

// الخطوة 2: إلغاء تعيين جميع متغيرات الجلسة
// تقوم هذه الدالة بإزالة جميع البيانات المخزنة في مصفوفة $_SESSION.
session_unset();

// الخطوة 3: تدمير الجلسة بالكامل
// هذه الدالة تقوم بتدمير كل البيانات المرتبطة بالجلسة الحالية على الخادم.
// كما أنها تقوم بحذف معرّف الجلسة.
session_destroy();

// الخطوة 4 (اختياري ولكن موصى به): حذف الكوكي الخاص بالجلسة من متصفح المستخدم
// لضمان عدم بقاء أي أثر للجلسة، نقوم بتعيين كوكي الجلسة بتاريخ انتهاء صلاحية في الماضي.
if (ini_get("session.use_cookies")) {
    $params = session_get_cookie_params();
    setcookie(session_name(), '', time() - 42000,
        $params["path"], $params["domain"],
        $params["secure"], $params["httponly"]
    );
}

// الخطوة 5: إعادة توجيه المستخدم إلى صفحة تسجيل الدخول
// بعد إنهاء الجلسة بنجاح، يتم توجيه المستخدم إلى صفحة الدخول.
header('Location: https://alfagolden.com/system/login.php');

// الخطوة 6: إيقاف تنفيذ السكريبت
// من المهم جداً استدعاء exit() بعد header('Location: ...') للتأكد
// من عدم تنفيذ أي كود إضافي بعد إعادة التوجيه.
exit;
?>